#!/usr/bin/env ruby
require 'fileutils'
include FileUtils

# path to your application root.
APP_ROOT = File.expand_path('..', __dir__)
ARG_KEYS = {}

ARGV.each {|v| ARG_KEYS[v] = true}

def system!(*args)
  system(*args) || abort("\n== Command #{args} failed ==")
end

chdir APP_ROOT do
  system! "#{APP_ROOT}/bin/deploy#{ARG_KEYS["--clear"] ? " --clear" : ''} www admin#{ARG_KEYS["--main"] ? '' : " year-2019 year-2020"}"
rescue Interrupt
  puts "\n== Cancelled Deployment =="
end
